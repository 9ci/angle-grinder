(function() {
    var SpinnerCtrl, spinner, __bind = function(fn, me) {
        return function() {
            return fn.apply(me, arguments);
        };
    };
    spinner = angular.module("angleGrinder.spinner", []);
    spinner.factory("httpRequestTracker", [ "$http", function($http) {
        return {
            jqueryAjaxRequest: false,
            hasPendingRequests: function() {
                return this.jqueryAjaxRequest || $http.pendingRequests.length > 0;
            }
        };
    } ]);
    SpinnerCtrl = function() {
        SpinnerCtrl.$inject = [ "$scope", "httpRequestTracker" ];
        function SpinnerCtrl($scope, httpRequestTracker) {
            this.$scope = $scope;
            this.httpRequestTracker = httpRequestTracker;
            this.showSpinner = __bind(this.showSpinner, this);
            this.$scope.showSpinner = this.showSpinner;
        }
        SpinnerCtrl.prototype.showSpinner = function() {
            return this.httpRequestTracker.hasPendingRequests();
        };
        return SpinnerCtrl;
    }();
    spinner.controller("spinner", SpinnerCtrl);
    spinner.directive("agSpinner", function() {
        return {
            replace: true,
            restrict: "E",
            template: '<li class="spinner">\n  <a href="#"><i ng-class="{spin: showSpinner()}"></i></a>\n</li>',
            controller: "spinner"
        };
    });
    spinner.run([ "$timeout", "httpRequestTracker", function($timeout, httpRequestTracker) {
        var jqeuryAjaxRequest;
        if (typeof jQuery === "undefined" || jQuery === null) {
            return;
        }
        jqeuryAjaxRequest = function(pending) {
            return $timeout(function() {
                return httpRequestTracker.jqueryAjaxRequest = pending;
            });
        };
        jQuery(document).ajaxStart(function() {
            return jqeuryAjaxRequest(true);
        });
        return jQuery(document).ajaxStop(function() {
            return jqeuryAjaxRequest(false);
        });
    } ]);
}).call(this);